<!DOCTYPE html>
<html lang="he" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rozenzweig Architectes</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Heebo:wght@200;300;400;600;700&display=swap"
      rel="stylesheet"
    />

    <style>
      /* Apply custom fonts */
      body {
        font-family: "Heebo", sans-serif;
        background-color: #111111;
      }

      /* Text animation keyframes */
      @keyframes slide-out-down {
        to {
          transform: translateY(100%);
          opacity: 0;
        }
      }

      @keyframes slide-in-down {
        from {
          transform: translateY(-100%);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      /* Classes to trigger animations */
      .slide-out {
        animation: slide-out-down 0.5s forwards ease-in-out;
      }
      .slide-in {
        animation: slide-in-down 0.5s forwards ease-in-out;
      }

      /* Visually hide content while keeping it accessible to screen readers */
      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border-width: 0;
      }

      /* Video transition styles */
      .video-item {
        transition: opacity 0.3s ease-in-out;
      }
    </style>
  </head>
  <body class="bg-black text-white min-h-screen lg:h-screen lg:overflow-hidden">
    <div id="app" class="h-full lg:grid lg:grid-cols-5">
      <aside
        id="desktop-video-container"
        class="hidden lg:block lg:col-span-2 h-full relative"
      >
        <video
          autoplay
          muted
          playsinline
          class="video-item absolute inset-0 w-full h-full object-cover"
          title="Architectural design montage"
        >
          <source src="moving_background.mp4" type="video/mp4" />
          Your browser does not support the video tag.
        </video>
        <video
          muted
          playsinline
          class="video-item absolute inset-0 w-full h-full object-cover opacity-0"
          title="Architectural design montage"
        >
          <source src="moving_background2.mp4" type="video/mp4" />
          Your browser does not support the video tag.
        </video>
        <video
          muted
          playsinline
          class="video-item absolute inset-0 w-full h-full object-cover opacity-0"
          title="Architectural design montage"
        >
          <source src="moving_background3.mp4" type="video/mp4" />
          Your browser does not support the video tag.
        </video>
      </aside>

      <main
        class="lg:col-span-3 flex flex-col h-full relative"
        style="background-color: rgba(51, 51, 51, 255)"
      >
        <div class="p-6 md:p-8 lg:p-12 flex flex-col flex-grow">
          <header class="flex items-center justify-center">
            <img
              src="logo.svg"
              alt="Rozenzweig Architectes Logo"
              class="w-16 lg:w-40"
            />
          </header>

          <section class="flex-grow flex flex-col justify-center">
            <div>
              <div
                class="h-px bg-gray-300 opacity-50 -mx-6 md:-mx-8 lg:-mx-12 mt-[14px]"
              ></div>

              <div class="py-10 text-center">
                <h1
                  class="text-2xl whitespace-nowrap md:text-5xl font-light mb-4 text-center tracking-widest"
                >
                  תכנון חכם מתחיל בניסיון
                </h1>

                <div
                  id="mobile-video-container"
                  class="lg:hidden mt-6 mb-8 relative h-64"
                >
                  <video
                    autoplay
                    muted
                    playsinline
                    class="video-item absolute inset-0 w-full h-full object-cover"
                    title="Architectural design montage"
                  >
                    <source src="moving_background.mp4" type="video/mp4" />
                    Your browser does not support the video tag.
                  </video>
                  <video
                    muted
                    playsinline
                    class="video-item absolute inset-0 w-full h-full object-cover opacity-0"
                    title="Architectural design montage"
                  >
                    <source src="moving_background2.mp4" type="video/mp4" />
                    Your browser does not support the video tag.
                  </video>
                  <video
                    muted
                    playsinline
                    class="video-item absolute inset-0 w-full h-full object-cover opacity-0"
                    title="Architectural design montage"
                  >
                    <source src="moving_background3.mp4" type="video/mp4" />
                    Your browser does not support the video tag.
                  </video>
                </div>
                <div
                  class="text-lg md:text-xl text-gray-200 font-extralight tracking-widest"
                >
                  <p class="relative right-2">
                    משרדנו מתמחה ב<span
                      id="animated-text-container"
                      class="inline-block relative overflow-hidden align-bottom w-32 text-right h-7"
                      ><span
                        id="animated-text"
                        class="absolute inset-0 whitespace-nowrap"
                        >בנייה רוויה.</span
                      ></span
                    >
                  </p>
                  <p>זה הזמן להפוך חלום למציאות.</p>
                </div>
              </div>

              <div
                class="h-px bg-gray-300 opacity-50 -mx-6 md:-mx-8 lg:-mx-12"
              ></div>
            </div>
          </section>

          <section class="pt-8" aria-labelledby="contact-heading">
            <h2
              id="contact-heading"
              class="text-center text-lg text-gray-200 mb-6"
            >
              יש לכם חזון? אנחנו נהפוך אותו לתכנון
            </h2>
            <form
              id="contact-form"
              class="w-full max-w-xl mx-auto"
              action="https://formspree.io/f/mrbklryl"
              method="POST"
            >
              <div
                class="flex flex-col sm:flex-row sm:flex-wrap sm:items-start sm:gap-6"
              >
                <div class="w-full sm:w-1/3 sm:order-1">
                  <label for="name" class="sr-only">שם</label>
                  <input
                    type="text"
                    id="name"
                    name="name"
                    class="bg-transparent border border-gray-400 text-white placeholder-gray-300 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 text-right transition-colors"
                    placeholder="שם"
                    required
                    aria-describedby="name-error"
                  />
                  <p
                    id="name-error"
                    class="text-red-400 text-xs text-right mt-1 h-4"
                    aria-live="polite"
                  ></p>
                </div>
                <div class="w-full sm:w-1/3 sm:order-2">
                  <label for="phone" class="sr-only">טלפון</label>
                  <input
                    type="tel"
                    id="phone"
                    name="phone"
                    class="bg-transparent border border-gray-400 text-white placeholder-gray-300 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 text-right transition-colors"
                    placeholder="טלפון"
                    required
                    aria-describedby="phone-error"
                  />
                  <p
                    id="phone-error"
                    class="text-red-400 text-xs text-right mt-1 h-4"
                    aria-live="polite"
                  ></p>
                </div>

                <fieldset class="w-full order-3 sm:order-4">
                  <legend class="sr-only">סיבת הפנייה</legend>
                  <div class="sm:hidden">
                    <label for="inquiry_type_mobile" class="sr-only"
                      >סיבת הפנייה</label
                    >
                    <select
                      id="inquiry_type_mobile"
                      name="inquiry_type"
                      class="bg-transparent border border-gray-400 text-white placeholder-gray-300 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 text-right transition-colors"
                      required
                    >
                      <option value="" disabled selected>תכנון</option>
                      <option value="כללי">כללי</option>
                      <option value="בית פרטי">בית פרטי</option>
                      <option value="בניה רוויה">בניה רוויה</option>
                      <option value="ממ״ד">ממ״ד</option>
                      <option value="תב״ע">תב״ע</option>
                    </select>
                  </div>
                  <div
                    class="hidden sm:flex flex-wrap justify-center items-center gap-x-4 sm:gap-x-[2.2rem] gap-y-2 relative sm:left-[3.9rem] left-0 mt-[-1rem]"
                  >
                    <div class="flex items-center">
                      <input
                        id="radio-general"
                        type="radio"
                        value="כללי"
                        name="inquiry_type"
                        class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500"
                      />
                      <label
                        for="radio-general"
                        class="ms-2 text-sm font-medium text-gray-200"
                        >כללי</label
                      >
                    </div>
                    <div class="flex items-center">
                      <input
                        id="radio-private"
                        type="radio"
                        value="בית פרטי"
                        name="inquiry_type"
                        class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500"
                      />
                      <label
                        for="radio-private"
                        class="ms-2 text-sm font-medium text-gray-200"
                        >בית פרטי</label
                      >
                    </div>
                    <div class="flex items-center">
                      <input
                        id="radio-saturated"
                        type="radio"
                        value="בניה רוויה"
                        name="inquiry_type"
                        class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500"
                      />
                      <label
                        for="radio-saturated"
                        class="ms-2 text-sm font-medium text-gray-200"
                        >בניה רוויה</label
                      >
                    </div>
                    <div class="flex items-center">
                      <input
                        id="radio-mamad"
                        type="radio"
                        value="ממ״ד"
                        name="inquiry_type"
                        class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500"
                      />
                      <label
                        for="radio-mamad"
                        class="ms-2 text-sm font-medium text-gray-200"
                        >ממ״ד</label
                      >
                    </div>
                    <div class="flex items-center">
                      <input
                        id="radio-taba"
                        type="radio"
                        value="תב״ע"
                        name="inquiry_type"
                        class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500"
                      />
                      <label
                        for="radio-taba"
                        class="ms-2 text-sm font-medium text-gray-200"
                        >תב״ע</label
                      >
                    </div>
                  </div>
                </fieldset>

                <div
                  class="w-full sm:flex-shrink-0 sm:w-auto order-4 sm:order-3 mt-4 sm:mt-0"
                >
                  <button
                    id="submit-button"
                    type="submit"
                    class="text-white bg-transparent border border-white hover:bg-white hover:text-black focus:ring-4 focus:outline-none focus:ring-gray-300 font-medium rounded-lg text-sm w-full px-8 py-2.5 text-center transition-colors"
                  >
                    שלח
                  </button>
                </div>
              </div>
            </form>
          </section>
        </div>
        <a
          href="https://wa.me/9720559183056"
          target="_blank"
          class="absolute top-8 left-8 z-10"
          aria-label="Contact us on WhatsApp"
        >
          <svg
            class="w-8 h-8"
            viewBox="0 0 24 24"
            role="img"
            aria-labelledby="whatsapp-title"
          >
            <title id="whatsapp-title">WhatsApp icon</title>
            <path
              fill="#25D366"
              d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"
            />
          </svg>
        </a>
      </main>
    </div>

    <div
      id="success-modal"
      class="hidden fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-50"
      role="dialog"
      aria-modal="true"
      aria-labelledby="modal-heading"
    >
      <div
        class="bg-gray-800 rounded-lg shadow-xl p-8 text-center max-w-sm mx-auto"
      >
        <p id="modal-heading" class="text-white text-lg mb-6">
          הפרטים נשלחו בהצלחה. ניצור איתכם קשר בהקדם
        </p>
        <button
          id="close-modal-button"
          class="text-gray-800 bg-white hover:bg-gray-200 focus:ring-4 focus:outline-none focus:ring-gray-300 font-medium rounded-lg text-sm px-8 py-2.5"
        >
          סגור
        </button>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // --- VIDEO SWITCHER LOGIC (UPDATED) ---
        function initializeVideoSwitcher(containerId) {
          const container = document.getElementById(containerId);
          if (!container) return;

          const videos = container.querySelectorAll(".video-item");
          if (videos.length < 2) return; // Need at least two videos to switch

          let currentVideoIndex = 0;

          // Function to set up the listener for the currently active video
          const scheduleNextVideo = () => {
            const currentVideo = videos[currentVideoIndex];

            // Define the event handler for time updates
            const timeUpdateHandler = () => {
              // Check if the video is loaded and we're within 0.5s of the end
              if (
                !isNaN(currentVideo.duration) &&
                currentVideo.duration - currentVideo.currentTime <= 0.5
              ) {
                // Remove this listener to prevent it from firing multiple times
                currentVideo.removeEventListener(
                  "timeupdate",
                  timeUpdateHandler
                );

                // Fade out the current video
                currentVideo.classList.add("opacity-0");

                // Determine the next video index
                currentVideoIndex = (currentVideoIndex + 1) % videos.length;
                const nextVideo = videos[currentVideoIndex];

                // Fade in the next video and play it
                nextVideo.classList.remove("opacity-0");
                nextVideo.play();

                // Set up the listener for the new video
                scheduleNextVideo();
              }
            };

            // Add the event listener to the current video
            currentVideo.addEventListener("timeupdate", timeUpdateHandler);
          };

          // Start the cycle with the first video
          scheduleNextVideo();
        }

        // Initialize for both desktop and mobile video containers
        initializeVideoSwitcher("desktop-video-container");
        initializeVideoSwitcher("mobile-video-container");

        // Get form and elements
        const form = document.getElementById("contact-form");
        const nameInput = document.getElementById("name");
        const phoneInput = document.getElementById("phone");
        const submitButton = document.getElementById("submit-button");
        const radioInquiry = document.querySelectorAll(
          'input[name="inquiry_type"]'
        );
        const selectInquiry = document.getElementById("inquiry_type_mobile");

        // Get error message elements
        const nameError = document.getElementById("name-error");
        const phoneError = document.getElementById("phone-error");

        // Get modal elements
        const successModal = document.getElementById("success-modal");
        const closeModalButton = document.getElementById("close-modal-button");

        // --- TEXT ANIMATION LOGIC ---
        const animatedTextSpan = document.getElementById("animated-text");
        const specializations = ["בנייה רוויה.", "בתים פרטיים", "גני אירועים"];
        let currentIndex = 0;

        setInterval(() => {
          animatedTextSpan.classList.add("slide-out");

          setTimeout(() => {
            currentIndex = (currentIndex + 1) % specializations.length;
            animatedTextSpan.textContent = specializations[currentIndex];

            animatedTextSpan.classList.remove("slide-out");
            animatedTextSpan.classList.add("slide-in");

            setTimeout(() => {
              animatedTextSpan.classList.remove("slide-in");
            }, 500);
          }, 500);
        }, 3000); // Change text every 3 seconds

        // --- SYNC RADIO AND SELECT ---
        // Sync select to radio
        selectInquiry.addEventListener("change", (e) => {
          const selectedRadio = document.querySelector(
            `input[name="inquiry_type"][value="${e.target.value}"]`
          );
          if (selectedRadio) {
            selectedRadio.checked = true;
          }
        });

        // Sync radio to select
        radioInquiry.forEach((radio) => {
          radio.addEventListener("change", (e) => {
            if (e.target.checked) {
              selectInquiry.value = e.target.value;
            }
          });
        });

        // --- VALIDATION LOGIC ---
        function validateName() {
          if (nameInput.value.trim() === "") {
            nameInput.classList.add("border-red-500");
            nameError.textContent = "שדה שם הוא שדה חובה.";
            return false;
          }
          return true;
        }

        function validatePhone() {
          // Regex for Israeli phone numbers (allows 9-10 digits, optional hyphen)
          const phoneRegex = /^0\d{1,2}-?\d{7}$/;
          if (!phoneRegex.test(phoneInput.value)) {
            phoneInput.classList.add("border-red-500");
            phoneError.textContent = "נא להזין מספר טלפון ישראלי חוקי.";
            return false;
          }
          return true;
        }

        function validateInquiry() {
          if (selectInquiry.value === "") {
            // In mobile view, check the select
            if (window.innerWidth < 640) {
              selectInquiry.classList.add("border-red-500");
              // You might want to add an error message element for the select
              return false;
            }
            // In desktop view, check if any radio is selected
            const anyRadioSelected = Array.from(radioInquiry).some(
              (radio) => radio.checked
            );
            if (!anyRadioSelected) {
              // You might want to add an error message for the radio group
              return false;
            }
          }
          return true;
        }

        // --- RESET ERRORS ---
        function clearErrors() {
          nameInput.classList.remove("border-red-500");
          nameError.textContent = "";
          phoneInput.classList.remove("border-red-500");
          phoneError.textContent = "";
          selectInquiry.classList.remove("border-red-500");
        }

        nameInput.addEventListener("input", clearErrors);
        phoneInput.addEventListener("input", clearErrors);
        selectInquiry.addEventListener("change", clearErrors);
        radioInquiry.forEach((radio) =>
          radio.addEventListener("change", clearErrors)
        );

        // --- FORM SUBMISSION ---
        form.addEventListener("submit", function (event) {
          event.preventDefault();
          clearErrors();

          const isNameValid = validateName();
          const isPhoneValid = validatePhone();
          const isInquiryValid = validateInquiry();

          if (!isNameValid || !isPhoneValid || !isInquiryValid) {
            return; // Stop if validation fails
          }

          // --- FETCH LOGIC ---
          const formData = new FormData(form);
          submitButton.disabled = true;
          submitButton.textContent = "שולח...";

          fetch(form.action, {
            method: "POST",
            body: formData,
            headers: {
              Accept: "application/json",
            },
          })
            .then((response) => {
              if (response.ok) {
                // Success
                form.reset();
                selectInquiry.value = ""; // Reset select to placeholder
                successModal.classList.remove("hidden");
                // Focus the close button in the modal for keyboard users
                closeModalButton.focus();
              } else {
                // Handle server errors
                response.json().then((data) => {
                  if (Object.hasOwn(data, "errors")) {
                    alert(
                      data["errors"].map((error) => error["message"]).join(", ")
                    );
                  } else {
                    alert("אירעה שגיאה. אנא נסה שוב.");
                  }
                });
              }
            })
            .catch((error) => {
              // Handle network errors
              alert("אירעה שגיאת רשת. אנא בדוק את החיבור ונסה שוב.");
            })
            .finally(() => {
              // Reset button state
              submitButton.disabled = false;
              submitButton.textContent = "שלח";
            });
        });

        // --- MODAL LOGIC ---
        closeModalButton.addEventListener("click", function () {
          successModal.classList.add("hidden");
          // Return focus to the element that opened the modal, or a sensible default
          nameInput.focus();
        });

        // Close modal if clicking outside of it
        successModal.addEventListener("click", function (e) {
          if (e.target === successModal) {
            successModal.classList.add("hidden");
            nameInput.focus();
          }
        });

        // Trap focus inside the modal
        successModal.addEventListener("keydown", function (e) {
          if (e.key === "Tab") {
            // There's only one focusable element (the button), so just prevent tabbing out
            e.preventDefault();
          }
          if (e.key === "Escape") {
            closeModalButton.click();
          }
        });
      });
    </script>
  </body>
</html>
